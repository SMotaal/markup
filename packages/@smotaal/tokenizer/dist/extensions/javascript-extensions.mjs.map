{"version":3,"file":"javascript-extensions.mjs","sources":["../../../packages/@smotaal/tokenizer/extensions/javascript/extended-modes.js"],"sourcesContent":["import {javascript} from './javascript-mode.js';\nimport {Symbols, sequence, raw, all} from '../helpers.js';\n\nexport const mjs = Object.defineProperties(\n  ({syntax} = mjs.defaults, {javascript: {quotes, closures, spans, matchers}}) => ({\n    syntax,\n    keywords: Symbols.from('import export default'),\n    quotes,\n    closures,\n    spans,\n    matcher: javascript.MJS,\n    matchers: {quote: matchers.quote, closure: javascript.CLOSURE},\n  }),\n  {\n    defaults: {get: () => ({...mjs.DEFAULTS})},\n  },\n);\n\nexport const cjs = Object.defineProperties(\n  ({syntax} = cjs.defaults, {javascript: {quotes, closures, spans, matchers}}) => ({\n    syntax,\n    keywords: Symbols.from('import module exports require'),\n    quotes,\n    closures,\n    spans,\n    matcher: javascript.CJS,\n    matchers: {quote: matchers.quote, closure: javascript.CLOSURE},\n  }),\n  {\n    defaults: {get: () => ({...cjs.DEFAULTS})},\n  },\n);\n\nexport const esx = Object.defineProperties(\n  ({syntax} = esx.defaults, {javascript: {quotes, closures, spans, matchers}, mjs, cjs}) => ({\n    syntax,\n    keywords: Symbols.from(mjs.keywords, cjs.keywords),\n    quotes,\n    closures,\n    spans,\n    matcher: javascript.ESX,\n    matchers: {quote: matchers.quote, closure: javascript.ESX},\n  }),\n  {\n    defaults: {get: () => ({...esx.DEFAULTS})},\n  },\n);\n\nDefinitions: {\n  Defaults: {\n    const requires = [javascript.defaults.syntax];\n\n    mjs.DEFAULTS = {syntax: 'mjs', aliases: ['esm'], requires};\n    cjs.DEFAULTS = {syntax: 'cjs', requires};\n    esx.DEFAULTS = {syntax: 'esx', requires: [...requires, 'cjs', 'mjs']};\n  }\n\n  const {REGEXPS, CLOSURES} = javascript;\n\n  // TODO: Undo $ matching once fixed\n  const QUOTES = /`|\"(?:[^\\\\\"]+|\\\\.)*(?:\"|$)|'(?:[^\\\\']+|\\\\.)*(?:'|$)/g;\n  const COMMENTS = /\\/\\/.*(?:\\n|$)|\\/\\*[^]*?(?:\\*\\/|$)|^\\#\\!.*\\n/g;\n  const STATEMENTS = all(QUOTES, CLOSURES, REGEXPS, COMMENTS);\n  const BLOCKLEVEL = sequence`([\\s\\n]+)|(${STATEMENTS})`;\n  const TOPLEVEL = sequence`([\\s\\n]+)|(${STATEMENTS})`;\n  javascript.CLOSURE = sequence`(\\n+)|(${STATEMENTS})`;\n  javascript.MJS = sequence`${TOPLEVEL}|\\bexport\\b|\\bimport\\b`;\n  javascript.CJS = sequence`${BLOCKLEVEL}|\\bexports\\b|\\bmodule.exports\\b|\\brequire\\b|\\bimport(?=\\(|\\.)`;\n  javascript.ESX = sequence`${BLOCKLEVEL}|\\bexports\\b|\\bimport\\b|\\bmodule.exports\\b|\\brequire\\b`;\n}\n"],"names":[],"mappings":"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"}